---
layout: post
title: SharePoint Framework Extensions Developer Preview Is Here!
date: '2017-06-09T14:17:00.001-07:00'
author: Alex Terentiev
tags:
- JavaScript
- SharePoint Online
- Field Customizer
- SPFx
- Application Customizer
- O365
- Command Set
- SharePoint Framework
- Office 365
- SharePoint Framework Extensions
modified_time: '2017-08-31T08:35:59.426-07:00'
thumbnail: https://2.bp.blogspot.com/-wiHuR8vi0_4/WTok66Qj-7I/AAAAAAAAAes/O9rJXC6KxboJ9u64tRcKMgMUjm2TaSj2wCLcB/s72-c/cell_in_row.png
blogger_id: tag:blogger.com,1999:blog-3066084330774405472.post-5207839786318277543
blogger_orig_url: http://blog.aterentiev.com/2017/06/sharepoint-framework-extensions.html
---

On 6/6/2017 Microsoft finally&nbsp;<a href="https://dev.office.com/blogs/announcing-availability-of-sharepoint-framework-extensions-developer-preview" target="_blank">announced</a>&nbsp;availability of SharePoint Framework Extensions Developer Preview - a set of allowed customizations to change user experience of sites, lists and document libraries. Drawing a parallel between "classic" SharePoint development and new features - this is a new iteration of JSLink, ScriptLink and custom actions.<br />Let's review currently available extensions and their usage.<br /><b>UPDATE:</b>&nbsp;on 8/29/2017 Release Candidate was announced. The post is updated to contain newer version of API.<br /><a name='more'></a><h2>Getting started with new features</h2><div><ol><li>SharePoint Framework Extensions are available for testing through Office 365 Developer Tenants during preview and later across all of the tenants, when they will GA. It means that you need an Office 365 Developer Tenant. Mercifully, you can get free Office 365 Developer Tenant by subscribing to&nbsp;<a href="http://dev.office.com/devprogram" target="_blank">Office 365 Developer Program</a>. Since September the Extensions will be propagated to First Release tenancies.</li><li>If you have not yet installed SharePoint Framework, please have a look on the&nbsp;<a href="https://dev.office.com/sharepoint/docs/spfx/set-up-your-development-environment" target="_blank">tutorial</a>&nbsp;about SharePoint Framework Development.</li><li>If you have already installed previous version of the SPFx then you need to execute the following command to update Yeoman template for SharePoint:<br /><pre class="brush: bash;">npm install -g @microsoft/generator-sharepoint</pre></li></ol>Now you're ready to go.<br /><h2>Application Customizer (ScriptLink)</h2></div><div>Application Customizer Extension is a feature that we previously knew as ScriptLink - a customization that is loaded to all the pages.<br /><h3>What can you do with this extension</h3></div><div>The most important feature is ability to run custom scripts on a modern page. In the RC you can run your code in  <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">onInit </span>method and also subscribe to <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">this.context.application._layoutChangedEvent</span> event.<br /><ol><li><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">onInit </span>allows you to run initialization code <b>before</b> the DOM of the page is ready. It also allows to get access to placeholders on the page. This method returns Promise object (similarly to Client Side Web Parts).</li><li><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">this.context.application._layoutChangedEvent&nbsp;</span>is called <b>each time </b>the layout is changing.</li></ol>Additionally, you can add your markup into a specially provided placeholders in the page's DOM (similar to Placeholders in Master pages and ASP.NET pages). &nbsp;To add your markup to a placeholder you should write the code similar to:<br /><pre class="brush: javascript">// receive placeholder<br />const placeHolder = this.context.placeholderProvider.tryCreateContent(PlaceholderName.Top);<br />// setting innerHTML of placeholder DOM element<br />placeHolder.domElement.innerHTML = '&lt;div style="background-color: red;"&gt;Attached&lt;/div&gt;';<br /></pre><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">this.context.placeholderProvider</span> is a helper that contains <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">placeholderNames </span>property with the names of all available placeholders, <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">tryCreateContent </span>method to receive a placeholder by name and options and <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">changedEvent</span> to add the handler that will be fired when set of available placeholders for the page was changed.<br />Some notes:<br /><ol><li>Only <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">Top, Bottom</span> placeholders are currently available (8/30/2017). Dev team promises to add more.</li></ol>While configuring Application Customizer in solution package you can provide optional properties. The properties will be available via <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">this.properties</span> property. It can be used, for example, to provide url to some config list.</div><h2>Field Customizer (Field JSLink)</h2><div>Field Customizer is a new iteration of Field JSLink. It allows to apply custom rendering to each cell in the field's column.<br /><h3>What can you do with this extension</h3></div><div>Customizer allows to insert any HTML into cell's div. There are 3 methods to override: <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">onInit</span>, <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">onRenderCell</span> and <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">onDisposeCell</span></div><div><br /><ol><li><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">onInit </span>method allows to run some initialization code and ensure that the execution of this code is finished before rendering.</li><li><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">onRenderCell </span>method is an entry point for actual rendering. You have access to cell's DOM element to render your content. Also, there is a bunch of helpful objects inside <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">this.properties</span> property and <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">event</span> object (such as cell value, field information, List View properties, etc.). <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">CellFormatter&nbsp;</span>helper class allows to format cell value as text (waiting for other features).</li><li><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">onDisposeCell </span>method allows to release all used resources.</li></ol></div><div>Below is a sample of the cell div and row div.</div><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-wiHuR8vi0_4/WTok66Qj-7I/AAAAAAAAAes/O9rJXC6KxboJ9u64tRcKMgMUjm2TaSj2wCLcB/s1600/cell_in_row.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="178" data-original-width="1600" height="70" src="https://2.bp.blogspot.com/-wiHuR8vi0_4/WTok66Qj-7I/AAAAAAAAAes/O9rJXC6KxboJ9u64tRcKMgMUjm2TaSj2wCLcB/s640/cell_in_row.png" width="640" /></a></div>There are 2 points to mention:<br /><ol><li>Each cell has margins and paddings with the content located <b>inside </b>the cell div. Remember, that your content is surrounded with these margins and paddings which are not under your direct control.</li><li>Cell div occupies only the space it needs (<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">display: inline-block</span>). Consequently its height may be less than height of the row.</li></ol>Similarly to Application customizer, Field Customizer can be configured with optional properties.<br /><h2>Command Set (ECB, Ribbon Custom Actions)</h2><div>Command Sets let developers extend the command surfaces of SharePoint to add new actions, along with client-side code that can be used to implement behaviors. Previously, we knew such extensions as Custom Actions with Location set to Ribbon or ECB.<br /><h3>What can you do with this extension</h3></div><div>You can add<br /><ul><li>custom buttons to the list's (document library's) command bar, or&nbsp;</li><li>menu items to item's context menu</li></ul>This buttons and menu items can contain custom code to execute some logic (just to remind: in new experience you could only add custom actions with URL as a command).<br />Provided entry points are <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">onRefreshCommand</span> and <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">onExecute</span>.</div><div><ol><li><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">onListViewUpdated </span>method allows you to change the state of the command based on current state of the list view. The <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">event </span>parameter contains <ul><li>&nbsp;information about currently selected rows,&nbsp;</li><li><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">commandId </span>(this one is needed because you can have multiple commands in single Command Set)&nbsp;</li><li>values of the command that can be changed: <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">title</span>, <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">visible</span>, <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">ariaLabel</span>, <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">iconImageUrl</span>.</li></ul></li><li><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">onExecute </span>method is an entry point for command's execution. Use this method to implement all the logic related to the command. And, similarly to&nbsp;<span style="font-family: &quot;courier new&quot;, courier, monospace;">onListViewUpdated</span>, you have access to <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">commandId </span>and selected rows through <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">event </span>parameter.</li></ol><h2>How to debug and deploy the extensions</h2></div><div>The process of running and debugging the extensions differs from client side web parts because the execution is done on the O365 dev tenant pages, not on local workbench page.<br />I will not cover this part in the post but you can use the links below to get information on how to debug and deploy your extensions:<br /><a href="https://dev.office.com/sharepoint/docs/spfx/extensions/get-started/build-a-hello-world-extension#debugging-your-application-customizer-using-gulp-serve-and-query-string-parameters" target="_blank">Debugging Application Customizer</a><br /><a href="https://dev.office.com/sharepoint/docs/spfx/extensions/get-started/serving-your-extension-from-sharepoint" target="_blank">Deploying Application Customizer to SharePoint</a><br /><a href="https://dev.office.com/sharepoint/docs/spfx/extensions/get-started/building-simple-field-customizer#debugging-your-field-customizer-using-gulp-serve-and-query-string-parameters" target="_blank">Debugging Field Customizer</a><br /><a href="https://dev.office.com/sharepoint/docs/spfx/extensions/get-started/building-simple-field-customizer#add-field-definition-to-solution-package-for-deployment" target="_blank">Deploying Field Customizer to SharePoint</a><br /><a href="https://dev.office.com/sharepoint/docs/spfx/extensions/get-started/building-simple-cmdset-with-dialog-api#debugging-your-listview-command-set-using-gulp-serve-and-query-string-parameters" target="_blank">Debugging Command Set</a><br /><a href="https://dev.office.com/sharepoint/docs/spfx/extensions/get-started/building-simple-cmdset-with-dialog-api#adding-listview-command-set-to-solution-package-for-deployment" target="_blank">Deploying Command Set to SharePoint</a><br /><h2>Resources</h2></div><div>Here are the links to helpful resources related to the SharePoint Framework Extensions</div><div><a href="https://dev.office.com/sharepoint/docs/spfx/extensions/overview-extensions" target="_blank">Overview of SharePoint Framework Extensions (preview)</a>&nbsp;- high-level overview of extensions by Microsoft and (in subsections) detailed description of creating your first extensions.</div><div><a href="https://github.com/SharePoint/sp-dev-fx-extensions" target="_blank">SharePoint Framework Extensions samples &amp; tutorial materials</a>&nbsp;- GitHub repository for the samples and materials related to the extensions.</div><div><a href="https://github.com/SharePoint/sp-dev-docs/wiki/Release-Notes---Extensions-Dev-Preview-Drop-1" target="_blank">Developer Preview Release Notes</a>&nbsp;- basic information on what is included and how to get new bits.<br /><a href="https://github.com/SharePoint/sp-dev-docs/wiki/Release-Notes---Extensions-RC-Drop-1.2">Extensions RC Release Notes</a>&nbsp;- here you can find the changes that were done in RC.</div><div><a href="http://aka.ms/sp-dev-uservoice" target="_blank">SharePoint Dev UserVoice</a>&nbsp;- a place to share new feature requests.</div><div><a href="https://github.com/SharePoint/sp-dev-docs/issues" target="_blank">SharePoint Framework Issues</a>&nbsp;- a place to post issues/questions related to SharePoint Framework.</div><div><a href="https://dev.office.com/devprogram" target="_blank">Office 365 Developer Program</a>&nbsp;- here you can get Office 365 Dev tenant.</div><div><a href="https://dev.office.com/sharepoint/docs/spfx/sharepoint-framework-overview" target="_blank">SharePoint Framework Overview</a>&nbsp;- here you can find information about SharePoint Framework, Toolchain, "get started" kit, etc.</div><div><a href="https://dev.office.com/blogs" target="_blank">Office Dev Center Blogs</a>&nbsp;- blog about Office 365 development.</div><div><br /></div><div>That's it for now. In next posts I'll provide samples of each type of extensions with some details and how-tos.</div><div><br /></div><div>Have fun!</div><div><ol></ol></div>