---
layout: post
title: Minimal Download Strategy and window.setTimeout issue
date: '2014-12-19T14:05:00.000-08:00'
author: Alex Terentiev
tags:
- JavaScript
- SharePoint 2013
- setTimeout
- SharePoint
modified_time: '2014-12-19T14:06:09.105-08:00'
blogger_id: tag:blogger.com,1999:blog-3066084330774405472.post-8157128571039255578
blogger_orig_url: http://blog.aterentiev.com/2014/12/minimal-download-strategy-and.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">Sometimes developers from Microsoft create mysterious things...<br />In two words the issue with setTimeout looks like that.<br /><a name='more'></a><br />There is a standard function <a href="http://www.w3schools.com/jsref/met_win_settimeout.asp" style="font-family: 'Courier New', Courier, monospace;" target="_blank">window.setTimeout</a>.&nbsp;You can provide the function to call, the interval in milliseconds to wait and some additional arguments to be applied to the function. For example:<br /><pre class="brush: javascript;">setTimeout(function(firstName, lastName) {<br />  alert(firstName + ' ' + lastName);<br />}, 1000, 'Alex', 'Terentiev');<br /></pre>And that code works fine if the Minimal Download Strategy is deactivated. But if it is activated you'll see "undefined undefined" in the alert window.<br />It is so because of the override in the start.js file:<br /><pre class="brush: javascript;">window.setTimeout = function() {<br />  var b;<br />  if (arguments.length &gt; 1 &amp;&amp; "function" == typeof arguments[0]) {<br />    var c = arguments[0];<br />    arguments[0] = function() {<br />      c();<br />      if ("undefined" != typeof b) {<br />        var d = Array.indexOf(a._timeoutArray, b);<br />        -1 != d &amp;&amp; a._timeoutArray.splice(d, 1)<br />      }<br />    }<br />  }<br />  if ("function" == typeof e)<br />    b = e.apply(window, arguments);<br />  else<br />    b = e(arguments[0], arguments[1]);<br />  "undefined" != typeof b &amp;&amp; a._timeoutArray.push(b);<br />  return b<br />}<br /></pre>The function you're trying to call is stored in variable <span style="font-family: Courier New, Courier, monospace;">c</span>. And it is calling just like <span style="font-family: Courier New, Courier, monospace;">c()</span> which means that it will not have any arguments you were passing to setTimeout.<br />It is just awesome!<br />You can fix that issue by adding some code to the callee function (the function you're calling after timeout): <br /><pre class="brush: javascript;">if (!arguments.length) {<br />  var caller = arguments.callee.caller;<br /><br />  if (caller) {<br />    var callerArgs = caller.arguments;<br />    // get arguments from callerArgs<br />  }<br />}<br /></pre>Have fun!</div>