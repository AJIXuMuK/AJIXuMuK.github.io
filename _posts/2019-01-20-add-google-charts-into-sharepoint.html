---
layout: post
title: Add Google Charts into SharePoint Framework Web Part
date: '2019-01-20T11:46:00.000-08:00'
author: Alex Terentiev
tags:
- SharePoint Online
- Client Side Web Part
- SPFx
- O365
- Google Charts
- SharePoint Framework
- Office 365
- SharePoint
modified_time: '2019-01-20T11:46:21.355-08:00'
thumbnail: https://3.bp.blogspot.com/-HmPuPjpiL8w/XETOmzw9H4I/AAAAAAAABAk/nidLpahITbIhpFLh010UzbF42gy_LSjQwCLcBGAs/s72-c/google-charts.png
blogger_id: tag:blogger.com,1999:blog-3066084330774405472.post-2015303535837982937
blogger_orig_url: http://blog.aterentiev.com/2019/01/add-google-charts-into-sharepoint.html
---

<style>.code { font-family: "courier new", "courier", monospace; font-size: 12px; } </style>This post is based on the <a href="https://github.com/SharePoint/sp-dev-docs/issues/3298" target="_blank">question</a> in sp-dev-docs repo.<br />The question is how can we render a Google Charts in SPFx web part.<br />Actually, it's pretty easy thing to do. <br /><a name='more'></a>As a starting point I'll be using the code provided in the question I mentioned above:<br /><pre class="brush: javascript;"><br />&lt;script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"&gt;&lt;/script&gt;<br />&lt;script type="text/javascript"&gt; <br />google.charts.load("current", {packages:["corechart"]}); <br />google.charts.setOnLoadCallback(drawChart); <br />function drawChart() { <br />  var data = google.visualization.arrayToDataTable([ ['Task', 'Hours per Day'], ['Work', 11], ['Eat', 2], ['Commute', 2], ['Watch TV', 2], ['Sleep', 7] ]);<br />  var options = {<br />    title: 'My Daily Activities',<br />    pieHole: 0.4,<br />  };<br /><br />  var chart = new google.visualization.PieChart(document.getElementById('donutchart'));<br />  chart.draw(data, options);<br />}<br />&lt;/script&gt;<br /></pre><br />So, we need to<br /><ul><li>Reference loader script from external CDN</li><li>Use that loader to load additional scripts for charts</li><li>Render a chart after all dependent scripts are loaded</li></ul>Let's apply it to SharePoint Framework!<br />Google Charts loader is a non-AMD script. So, we need to proceed with steps from <a href="https://docs.microsoft.com/en-us/sharepoint/dev/spfx/web-parts/basics/add-an-external-library#load-a-non-amd-module" target="_blank">official documentation</a> on how to load a non-AMD module.<br />First, let's update <span class="code">config/config.json</span> to reference external script with global namespace <span class="code">google</span>: <pre class="brush: javascript;"><br />"externals": {<br />  "google": {<br />    "path": "https://www.gstatic.com/charts/loader.js",<br />    "globalName": "google"<br />  }<br />}<br /></pre>Next, let's add typings for the script that will contain basic declaration of the module and available properties/functions. For that let's add <span class="code">typings</span> folder into <span class="code">src</span> and <span class="code">google.d.ts</span> file.<br />For the simplicity I've just added 2 properties into declaration: <span class="code">charts</span> and <span class="code">visualization</span>. <pre class="brush: typescript;"><br />declare module "google" {<br />    interface IGoogle {<br />        charts: any;<br />        visualization: any;<br />    }<br /><br />    var google: IGoogle;<br />    export = google;<br />}<br /></pre>Now we can reference the module in our web part code: <pre class="brush: typescript;"><br />import * as google from 'google';<br /></pre>This import will also search for the external script declaration in our <span class="code">config.json</span> file and load <span class="code">loader.js</span> script from external CDN.<br />Next, let's modify web part's <span class="code">render</span> method to remove all unnecessary HTML and leave there a single <span class="code">div</span> with pre-defined id that will be used later to render a chart: <pre class="brush: typescript;"><br />public render(): void {<br />  this.domElement.innerHTML = `<br />    &lt;div class="${ styles.helloWorld}" id="pie-chart"&gt;<br />    &lt;/div&lt;`;<br />}<br /></pre>Next step is to implement chart rendering function that will be called after Google Charts scripts are loaded: <pre class="brush: typescript;"><br />private _drawChart() {<br />  const data = google.visualization.arrayToDataTable([ <br />    ['Task', 'Hours per Day'], <br />    ['Work', 11], <br />    ['Eat', 2], <br />    ['Commute', 2], <br />    ['Watch TV', 2], <br />    ['Sleep', 7] ]);<br />  const options = {<br />    title: 'My Daily Activities',<br />    pieHole: 0.4,<br />  };<br /><br />  const chart = new google.visualization.PieChart(document.getElementById('pie-chart'));<br />  chart.draw(data, options);<br />}<br /></pre>Now we're ready to call Google Charts loader API to load needed dependencies and set callback function. I did that in <span class="code">onInit</span> method of the web part as it should be done only once and logically it's the right place to load additional resources for the web part: <pre class="brush: typescript;"><br />protected onInit(): Promise<void> {<br />  google.charts.load("current", { packages: ["corechart"] });<br />  google.charts.setOnLoadCallback(this._drawChart.bind(this));<br /><br />  return super.onInit();<br />}<br /></pre>Now we can run our solution with <span class="code">gulp serve</span> and see Google Charts in action:<br /><a href="https://3.bp.blogspot.com/-HmPuPjpiL8w/XETOmzw9H4I/AAAAAAAABAk/nidLpahITbIhpFLh010UzbF42gy_LSjQwCLcBGAs/s1600/google-charts.png" imageanchor="1" ><img border="0" src="https://3.bp.blogspot.com/-HmPuPjpiL8w/XETOmzw9H4I/AAAAAAAABAk/nidLpahITbIhpFLh010UzbF42gy_LSjQwCLcBGAs/s1600/google-charts.png" data-original-width="1600" data-original-height="565" width="600" /></a><br />And that's it! Google Charts are added to the SharePoint Framework web part!<br />You can find the code for this sample <a href="https://github.com/AJIXuMuK/issues/tree/master/google-charts" target="_blank">here</a>.<br />I want to mention that this sample is not final solution to be reused without modifications as it doesn't contain some additional must-haves like checking in <span class="code">_drawChart</span> if <span class="code">pie-chart</span> div has been added to the DOM and so on. So, think of it as a starting point for your implementation.<br /><br />That's it for today!<br />Have fun!