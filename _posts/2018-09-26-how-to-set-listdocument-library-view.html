---
layout: post
title: 'How to: Set List/Document Library View Page as Modern Team Site Welcome  Page
  (Homepage)'
date: '2018-09-26T20:42:00.000-07:00'
author: Alex Terentiev
tags:
- SharePoint Online
- JSOM
- C#
- Welcome Page
- Office 365
- Homepage
- PnP
- PnP PowerShell
- PowerShell
- O365
- Client Side Object Model
- CSOM
modified_time: '2019-07-23T08:57:34.387-07:00'
thumbnail: https://3.bp.blogspot.com/-niIlteglGtg/W6xLBdlptdI/AAAAAAAAA7M/fZJYUTbrmoQw25rOLj1unrt-GDchGjeLQCLcBGAs/s72-c/Homepage.png
blogger_id: tag:blogger.com,1999:blog-3066084330774405472.post-6229683554851032521
blogger_orig_url: http://blog.aterentiev.com/2018/09/how-to-set-listdocument-library-view.html
---

<style>.code { font-family: "courier new", "courier", monospace; font-size: 12px; } </style>When you need to change the Home Page of Modern Team Site in SharePoint Online it's pretty easy to do through UI.<br />Just go to the Pages library, open context menu for the page you want to make a homepage and select "Make homepage"<br /><a href="https://3.bp.blogspot.com/-niIlteglGtg/W6xLBdlptdI/AAAAAAAAA7M/fZJYUTbrmoQw25rOLj1unrt-GDchGjeLQCLcBGAs/s1600/Homepage.png" imageanchor="1"><img border="0" data-original-height="934" data-original-width="1177" src="https://3.bp.blogspot.com/-niIlteglGtg/W6xLBdlptdI/AAAAAAAAA7M/fZJYUTbrmoQw25rOLj1unrt-GDchGjeLQCLcBGAs/s1600/Homepage.png" width="600" /></a><br />But what if the page you want to make a homepage is a Document Library or List View Page that is, obviously, not presented in the Pages library?<br /><a name='more'></a>One of the ideas that could get into a mind is to use "Welcome page" functionality from Classic Publishing SharePoint site.<br />Even if the Publishing feature is not activated, the page is available and accessible using url (relative to the site) <span class="code">_layouts/15/AreaWelcomePage.aspx</span>.<br />But if you try to set the url to library's View page there you'll get the error listed below:<br /><a href="https://1.bp.blogspot.com/-jjOOCfCkZSM/W6xNKcr25rI/AAAAAAAAA7k/Ol38DKDUPVIIP5pGrv6BNOyO3zZcD96DQCLcBGAs/s1600/homepage-error.png" imageanchor="1" ><img border="0" src="https://1.bp.blogspot.com/-jjOOCfCkZSM/W6xNKcr25rI/AAAAAAAAA7k/Ol38DKDUPVIIP5pGrv6BNOyO3zZcD96DQCLcBGAs/s1600/homepage-error.png" data-original-width="1466" data-original-height="205" width="600" /></a><br />Thankfully, we have <a href="https://github.com/SharePoint/PnP-PowerShell" target="_blank">PnP PowerShell</a>, CSOM and JSOM:<br /><pre class="brush: bash;"><br />Connect-PnPOnline https://yourcompany.sharepoint.com/sites/yoursitecollection<br />$site = Get-PnPSite<br />$web = $site.OpenSite("WebRelativeUrl") # you can use $site.RootSite for root site of the site collection<br />$folder = $web.RootFolder<br />$folder.WelcomePage = "Shared%20Documents/Forms/AllItems.aspx"<br />$folder.Update()<br />$web.Update()<br />Invoke-PnPQuery<br /></pre>That's all you need. After executing the script you'll have you homepage set to Documents All Items View page.<br />Same using CSOM: <pre class="brush: csharp;"><br />using(var ctx = new ClientContext("https://yourcompany.sharepoint.com/sites/yoursite"))<br />{<br />  ctx.Credentials = new SharePointOnlineCredentials(username, password);<br />  var site = ctx.Site;<br />  var web = site.OpenWeb("WebRelativeUrl"); // you can use site.RootWeb for root site of the site collection<br />  var rootFolder = web.RootFolder;<br />  rootFolder.WelcomePage = "Shared%20Documents/Forms/AllItems.aspx";<br />  rootFolder.Update();<br />  web.Update();<br />  ctx.ExecuteQuery();<br />}<br /></pre>Or, using JSOM: <pre class="brush: javascript;"><br />var ctx = SP.ClientContext.get_current();<br />var site = ctx.get_site();<br />var web = site.openWeb('WebRelativeUrl'); // you can use site.get_rootWeb() for root site of the site collection<br />var folder = web.get_rootFolder();<br />folder.set_welcomePage('Shared%20Documents/Forms/AllItems.aspx');<br />folder.update();<br />web.update();<br />ctx.executeQueryAsync(() =&gt; { console.log('success'); }, () =&gt; { console.log('error'); });<br /></pre><br />That's it!<br /><br />Have fun! 